<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgroUsluga - Košnja, Obrezovanje, Mulčenje</title>
  <meta name="description" content="Kosimo travo, obrezujemo drevesa in trte, mulčimo v Sloveniji. Testna košnja 100 m² zastonj (plačate potne stroške). Popusti za površine nad 10 arov!">
  <meta property="og:title" content="AgroUsluga - Košnja in Obrezovanje">
  <meta property="og:description" content="Testna košnja 100 m² zastonj, plačate le potne stroške! Popusti za površine nad 10 arov. Naročite na agrousluga.github.io!">
  <meta property="og:image" content="https://via.placeholder.com/1200x630?text=AgroUsluga">
  <meta property="og:url" content="https://agrousluga.github.io">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.emailjs.com/sdk/latest/email.min.js"></script>
</head>
<body class="bg-gray-100 font-sans">
  <!-- Header -->
  <header class="bg-green-600 text-white py-4">
    <div class="container mx-auto text-center">
      <h1 class="text-3xl font-bold">AgroUsluga</h1>
      <p class="text-lg">Košnja, obrezovanje dreves in trte, mulčenje – testna košnja 100 m² zastonj!</p>
    </div>
  </header>

  <!-- Gallery -->
  <section class="container mx-auto py-8">
    <h2 class="text-2xl font-semibold text-center mb-4">Naše delo</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <img src="kosnja.jpg" alt="Košnja trave" class="w-full h-auto rounded-lg">
        <p class="text-center mt-2">Košnja trave</p>
      </div>
      <div>
        <img src="obrezovanje.jpg" alt="Obrezovanje dreves" class="w-full h-auto rounded-lg">
        <p class="text-center mt-2">Obrezovanje dreves</p>
      </div>
      <div>
        <img src="mulcenje.jpg" alt="Mulčenje" class="w-full h-auto rounded-lg">
        <p class="text-center mt-2">Mulčenje</p>
      </div>
    </div>
  </section>

  <!-- Main Section -->
  <section class="container mx-auto py-8">
    <div class="flex flex-col md:flex-row gap-8">
      <!-- About -->
      <div class="md:w-1/2 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold mb-4">Naše storitve</h2>
        <p class="mb-4">Urejamo vaše parcele po Sloveniji. Ponujamo:</p>
        <ul class="list-disc pl-5 mb-4">
          <li><strong>Testna košnja zastonj</strong>: 100 m² brezplačno, plačate le potne stroške.</li>
          <li><strong>Popusti</strong>: Za površine nad 10 arov (1000 m²) ugodne cene po dogovoru.</li>
          <li><strong>Košnja trave</strong>: Hitro in zanesljivo, cena odvisna od terena.</li>
          <li><strong>Obrezovanje dreves/trte</strong>: Sadovnjaki, vinogradi, okrasna drevesa.</li>
          <li><strong>Mulčenje/sajenje</strong>: Čiščenje parcel, kompost, sajenje.</li>
        </ul>
        <p>Plačilo na TRR ali z gotovino ob storitvi.</p>
      </div>

      <!-- Form -->
      <div class="md:w-1/2 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold mb-4">Naroči storitev</h2>
        <form id="agro-form" class="space-y-4">
          <div>
            <label for="ime" class="block text-sm font-medium">Ime in priimek</label>
            <input type="text" id="ime" name="ime" class="w-full p-2 border rounded" required>
          </div>
          <div>
            <label for="naslov" class="block text-sm font-medium">Naslov parcele</label>
            <input type="text" id="naslov" name="naslov" class="w-full p-2 border rounded" required>
          </div>
          <div>
            <label for="povrsina" class="block text-sm font-medium">Površina (m²)</label>
            <input type="number" id="povrsina" name="povrsina" class="w-full p-2 border rounded" required>
          </div>
          <div>
            <label for="storitev" class="block text-sm font-medium">Izberite storitev</label>
            <select id="storitev" name="storitev" class="w-full p-2 border rounded" required>
              <option value="kosnja">Košnja trave</option>
              <option value="obrezovanje_dreves">Obrezovanje dreves</option>
              <option value="obrezovanje_trte">Obrezovanje trte</option>
              <option value="mulcenje">Mulčenje</option>
              <option value="sajenje">Sajenje/čiščenje</option>
            </select>
          </div>
          <div>
            <label for="email" class="block text-sm font-medium">E-pošta</label>
            <input type="email" id="email" name="email" class="w-full p-2 border rounded" required>
          </div>
          <button type="submit" class="bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">Pošlji naročilo</button>
        </form>
        <p class="mt-4 text-sm text-gray-600">
          Ali pišite direktno na <a href="mailto:agrousluga@proton.me?subject=Novo%20naročilo%20iz%20AgroUsluga&body=Ime:%0ANaslov%20parcele:%0APovršina:%0AStoritev:%0AE-pošta:%0A" class="text-blue-600 underline">agrousluga@proton.me</a> za hitrejši odziv!
        </p>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section class="bg-gray-200 py-8">
    <div class="container mx-auto text-center">
      <h2 class="text-2xl font-semibold mb-4">Kontakt</h2>
      <p>E-pošta: <a href="mailto:agrousluga@proton.me" class="text-blue-600">agrousluga@proton.me</a></p>
      <p>Plačilo na TRR ali z gotovino ob storitvi</p>
      <p>Delimo na <a href="https://www.facebook.com" target="_blank" class="text-blue-600">Facebooku</a>!</p>
    </div>
  </section>

  <!-- JavaScript -->
  <script>
    // Check if EmailJS is loaded
    window.onload = function() {
      if (typeof emailjs === 'undefined') {
        console.error('EmailJS SDK ni naložen!');
        alert('Napaka: EmailJS ni naložen. Uporabite direktni e-poštni naslov.');
      } else {
        console.log('EmailJS SDK uspešno naložen.');
        emailjs.init("z5qg90tnSqROlHHiU"); // EmailJS Public Key
      }
    };

    // Form submission
    document.getElementById('agro-form').addEventListener('submit', function(event) {
      event.preventDefault();
      console.log('Obrazec poslan, pošiljam EmailJS...');
      const formData = new FormData(this);
      const data = {
        ime: formData.get('ime'),
        naslov: formData.get('naslov'),
        povrsina: formData.get('povrsina'),
        storitev: formData.get('storitev'),
        email: formData.get('email'),
        to_email: "agrousluga@proton.me" // Pošiljanje na ProtonMail
      };
      console.log('Podatki obrazca:', data);

      // Send email via EmailJS
      emailjs.sendForm('service_zui3ysm', 'template_d0h55ir', this)
        .then(() => {
          console.log('E-mail uspešno poslan!');
          alert('Naročilo poslano! Prejeli boste delovni nalog in oceno po ogledu.');
          generateWorkOrder(data);
        }, (error) => {
          console.error('Napaka pri pošiljanju:', error);
          alert('Napaka pri pošiljanju: ' + JSON.stringify(error) + '. Poskusite direktno na agrousluga@proton.me.');
        });
    });

    // Generate Work Order PDF
    function generateWorkOrder(data) {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(16);
      doc.text('Delovni nalog - AgroUsluga', 20, 20);
      doc.setFontSize(12);
      doc.text(`Ime: ${data.ime}`, 20, 40);
      doc.text(`Naslov parcele: ${data.naslov}`, 20, 50);
      doc.text(`Površina: ${data.povrsina} m²`, 20, 60);
      doc.text(`Storitev: ${data.storitev.replace('_', ' ')}`, 20, 70);
      doc.text(`E-pošta: ${data.email}`, 20, 80);
      doc.text(`Datum: ${new Date().toLocaleDateString('sl-SI')}`, 20, 90);
      doc.text(`Opomba: Testna košnja 100 m² zastonj, plačate potne stroške. Cena po ogledu.`, 20, 100);
      doc.save(`delovni_nalog_${data.ime}_${new Date().toISOString().slice(0,10)}.pdf`);
    }
  </script>
</body>
</html>
